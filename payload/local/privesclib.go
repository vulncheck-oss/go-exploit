//go:generate nasm -f bin -o privesclib_amd64 privesclib_amd64.asm
package local

import _ "embed"

//go:embed privesclib_amd64
var privEscSharedLibraryAMD64 []byte

// This payload contains a payload that generates a small Linux AMD64 shared object that will
// trigger setuid/setgid and then spawn a /bin/sh shell. This payload is used often for attacks such
// as incorrect path loading or LD_PRELOAD attacks. This specific implementation is minimized to be
// around 204 bytes compiled and uses `nasm`.
func (p *PrivEscLibraryPayload) AMD64() []byte {
	return privEscSharedLibraryAMD64
}
